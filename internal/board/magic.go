package board

import "math/bits"

var RookMagics = [64]uint64{
	0xa8002c862a041044, 0x10441c0008408204, 0x101010101102020, 0x2100140210004000,
	0x4110802000a01100, 0x44101080800010, 0x10302020401012, 0x10008200100042,
	0x22202020004120, 0x211020080004020, 0x211020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x211020080004020, 0x211020080004020,
	0x211020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
	0x201020080004020, 0x201020080004020, 0x201020080004020, 0x201020080004020,
}

var BishopMagics = [64]uint64{
	0x89a1121896040240, 0x2048482c80410080, 0x610092244010040, 0x40220801008200,
	0x401080820200100, 0x110004010c801100, 0x112004040801200, 0x1004020051200,
	0x2028202a0020200, 0x4100880320824, 0x40120280403, 0x440a080130200,
	0x120820400010020, 0x210c081088000, 0x4010201100812, 0x110021004010a00,
	0x100011044100, 0x20010111100, 0x10122110202000, 0x41108210400,
	0x40810c1010002, 0x111080100040, 0x10010101010008, 0x8021020013011,
	0x10201202004002, 0x10120204000, 0x210102100021, 0x100040080080080,
	0x1004010010040, 0x10080010041, 0x1020080081100, 0x200202101001,
	0x200800110021, 0x801010110, 0x800800801000, 0x1020404011,
	0x40104080a0010, 0x1101040010242, 0x11005201040802, 0x80080801000802,
	0x40102001008400, 0x201000402000, 0x1001001100040, 0x100101000,
	0x120010020102, 0x40021002004, 0x4010100108200, 0x1001010010010,
	0x210408200010, 0x100210202001, 0x4002081011, 0x211021040001,
	0x20a0104100, 0x4080081001, 0x81010102, 0x104004100,
	0x2040404040412, 0x81001100040400, 0x40483010000, 0x210410411,
	0x400020810, 0x200010011, 0x40483010000, 0x800104008,
}

var (
	RookTable   [102400]uint64
	BishopTable [5248]uint64

	RookTableOffsets   [64]int
	BishopTableOffsets [64]int

	RookShifts   [64]uint8
	BishopShifts [64]uint8
)

func InitMagics() {
	rookOffset := 0
	bishopOffset := 0

	for sq := range 64 {
		rBits := uint8(bits.OnesCount64(RookRelevantMasks[sq]))
		bBits := uint8(bits.OnesCount64(BishopRelevantMasks[sq]))

		RookShifts[sq] = 64 - rBits
		BishopShifts[sq] = 64 - bBits

		RookTableOffsets[sq] = rookOffset
		BishopTableOffsets[sq] = bishopOffset

		rookOffset += (1 << rBits)
		bishopOffset += (1 << bBits)

		// fillRookTable(sq)
		// fillBishopTable(sq)
	}
}
